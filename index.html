<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sean's Daily Ops</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Daily Ops">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0a0a0a">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@300;400;500;600;700&family=Courier+Prime:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0a;
    --surface: #111;
    --surface2: #181818;
    --border: #222;
    --border2: #2e2e2e;
    --text: #f0f0ee;
    --muted: #555;
    --muted2: #888;
    --accent: #e8ff47;
    --accent-dim: rgba(232,255,71,0.12);
    --green: #4ade80;
    --green-dim: rgba(74,222,128,0.1);
    --red: #f87171;
    --blue: #60a5fa;
    --blue-dim: rgba(96,165,250,0.1);
    --orange: #fb923c;
    --purple: #c084fc;
    --teal: #2dd4bf;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Outfit', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* NOISE TEXTURE */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
    opacity: 0.5;
  }

  /* â”€â”€ TOPBAR â”€â”€ */
  .topbar {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(10,10,10,0.92);
    backdrop-filter: blur(16px);
    border-bottom: 1px solid var(--border);
    padding: 14px 28px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    flex-wrap: wrap;
  }
  .topbar-left {
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .app-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 26px;
    letter-spacing: 0.05em;
    color: var(--accent);
    line-height: 1;
  }
  .today-badge {
    font-family: 'Courier Prime', monospace;
    font-size: 11px;
    color: var(--muted2);
    letter-spacing: 0.08em;
    border: 1px solid var(--border2);
    padding: 4px 10px;
    border-radius: 20px;
  }

  .shift-toggle {
    display: flex;
    gap: 4px;
    background: var(--surface);
    border: 1px solid var(--border2);
    padding: 3px;
    border-radius: 8px;
  }
  .shift-btn {
    font-family: 'Outfit', sans-serif;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    padding: 6px 14px;
    border: none;
    border-radius: 6px;
    background: transparent;
    color: var(--muted2);
    cursor: pointer;
    transition: all 0.2s;
  }
  .shift-btn.active {
    background: var(--accent);
    color: #000;
  }

  /* â”€â”€ DAY SELECTOR â”€â”€ */
  .day-selector-wrap {
    padding: 24px 28px 0;
  }
  .day-selector-label {
    font-family: 'Courier Prime', monospace;
    font-size: 10px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 12px;
  }
  .day-pills {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-bottom: 24px;
  }
  .day-pill {
    position: relative;
    cursor: pointer;
    border-radius: 10px;
    border: 1.5px solid var(--border2);
    padding: 10px 16px;
    background: var(--surface);
    transition: all 0.2s;
    min-width: 72px;
    text-align: center;
    user-select: none;
  }
  .day-pill:hover { border-color: #444; background: var(--surface2); }
  .day-pill.active {
    border-color: var(--accent);
    background: var(--accent-dim);
  }
  .day-pill.active .pill-name { color: var(--accent); }
  .pill-name {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 18px;
    letter-spacing: 0.05em;
    color: var(--text);
    line-height: 1;
    margin-bottom: 2px;
  }
  .pill-sub {
    font-size: 9px;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--muted);
  }
  .pill-done-dot {
    position: absolute;
    top: 6px; right: 6px;
    width: 7px; height: 7px;
    border-radius: 50%;
    background: var(--green);
    display: none;
  }
  .day-pill.has-history .pill-done-dot { display: block; }

  /* â”€â”€ PROGRESS BAR â”€â”€ */
  .progress-wrap {
    padding: 0 28px 20px;
  }
  .progress-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }
  .progress-label {
    font-family: 'Courier Prime', monospace;
    font-size: 10px;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--muted);
  }
  .progress-count {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 18px;
    color: var(--accent);
    letter-spacing: 0.05em;
  }
  .progress-track {
    height: 4px;
    background: var(--border2);
    border-radius: 2px;
    overflow: hidden;
  }
  .progress-fill {
    height: 100%;
    background: var(--accent);
    border-radius: 2px;
    transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    width: 0%;
  }

  /* â”€â”€ MAIN CONTENT â”€â”€ */
  .content {
    padding: 0 28px 40px;
    display: grid;
    grid-template-columns: 1fr 320px;
    gap: 20px;
    align-items: start;
  }

  /* â”€â”€ TASK LIST â”€â”€ */
  .task-list { display: flex; flex-direction: column; gap: 8px; }

  .task-card {
    background: var(--surface);
    border: 1px solid var(--border2);
    border-radius: 10px;
    padding: 14px 16px;
    display: flex;
    align-items: flex-start;
    gap: 14px;
    cursor: pointer;
    transition: all 0.2s;
    animation: slideIn 0.35s ease both;
    position: relative;
    overflow: hidden;
  }
  .task-card::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 3px;
    background: var(--card-color, var(--border2));
    opacity: 0;
    transition: opacity 0.2s;
  }
  .task-card:hover { border-color: #333; background: var(--surface2); }
  .task-card:hover::before { opacity: 1; }
  .task-card.done {
    opacity: 0.55;
    background: var(--surface);
  }
  .task-card.done .task-label { text-decoration: line-through; color: var(--muted2); }
  .task-card.done::before { opacity: 1; background: var(--green); }

  .task-check {
    width: 22px; height: 22px;
    border-radius: 6px;
    border: 1.5px solid var(--border2);
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
    margin-top: 1px;
    transition: all 0.2s;
    font-size: 12px;
  }
  .task-card.done .task-check {
    background: var(--green);
    border-color: var(--green);
    color: #000;
  }

  .task-body { flex: 1; min-width: 0; }
  .task-time {
    font-family: 'Courier Prime', monospace;
    font-size: 10px;
    letter-spacing: 0.1em;
    color: var(--muted);
    margin-bottom: 3px;
    text-transform: uppercase;
  }
  .task-label {
    font-size: 14px;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 2px;
  }
  .task-note {
    font-size: 11px;
    color: var(--muted2);
    font-weight: 300;
  }
  .task-tag {
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    padding: 2px 8px;
    border-radius: 20px;
    margin-top: 5px;
    display: inline-block;
  }

  @keyframes slideIn {
    from { opacity: 0; transform: translateX(-8px); }
    to { opacity: 1; transform: translateX(0); }
  }
  .task-card:nth-child(1)  { animation-delay: 0.02s; }
  .task-card:nth-child(2)  { animation-delay: 0.05s; }
  .task-card:nth-child(3)  { animation-delay: 0.08s; }
  .task-card:nth-child(4)  { animation-delay: 0.11s; }
  .task-card:nth-child(5)  { animation-delay: 0.14s; }
  .task-card:nth-child(6)  { animation-delay: 0.17s; }
  .task-card:nth-child(7)  { animation-delay: 0.20s; }
  .task-card:nth-child(8)  { animation-delay: 0.23s; }
  .task-card:nth-child(9)  { animation-delay: 0.26s; }
  .task-card:nth-child(10) { animation-delay: 0.29s; }

  /* â”€â”€ SIDEBAR â”€â”€ */
  .sidebar { display: flex; flex-direction: column; gap: 16px; }

  .sidebar-card {
    background: var(--surface);
    border: 1px solid var(--border2);
    border-radius: 10px;
    padding: 18px 20px;
  }
  .sidebar-card h3 {
    font-family: 'Courier Prime', monospace;
    font-size: 10px;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 14px;
  }

  /* WEEKLY HEATMAP */
  .heatmap { display: flex; flex-direction: column; gap: 8px; }
  .heatmap-row {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .heatmap-day-label {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 13px;
    letter-spacing: 0.05em;
    color: var(--muted2);
    width: 32px;
    flex-shrink: 0;
  }
  .heatmap-bar-wrap {
    flex: 1;
    height: 20px;
    background: var(--border);
    border-radius: 4px;
    overflow: hidden;
    position: relative;
  }
  .heatmap-bar {
    height: 100%;
    border-radius: 4px;
    transition: width 0.6s cubic-bezier(0.34, 1.2, 0.64, 1);
  }
  .heatmap-pct {
    font-family: 'Courier Prime', monospace;
    font-size: 10px;
    color: var(--muted);
    width: 30px;
    text-align: right;
    flex-shrink: 0;
  }

  /* STREAK */
  .streak-display {
    display: flex;
    align-items: baseline;
    gap: 6px;
    margin-bottom: 8px;
  }
  .streak-num {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 52px;
    color: var(--accent);
    line-height: 1;
  }
  .streak-unit {
    font-size: 13px;
    color: var(--muted2);
    font-weight: 500;
  }
  .streak-sub {
    font-size: 11px;
    color: var(--muted);
    line-height: 1.5;
  }

  /* WEEKLY DOTS */
  .week-dots {
    display: flex;
    gap: 6px;
    margin-top: 12px;
  }
  .w-dot {
    flex: 1;
    aspect-ratio: 1;
    border-radius: 4px;
    background: var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Bebas Neue', sans-serif;
    font-size: 11px;
    color: var(--muted);
    position: relative;
  }
  .w-dot.partial { background: rgba(232,255,71,0.2); color: var(--accent); }
  .w-dot.full { background: var(--accent); color: #000; }

  /* LOG */
  .log-list { display: flex; flex-direction: column; gap: 6px; max-height: 200px; overflow-y: auto; }
  .log-list::-webkit-scrollbar { width: 3px; }
  .log-list::-webkit-scrollbar-track { background: transparent; }
  .log-list::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }
  .log-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    font-size: 11px;
    padding: 7px 10px;
    background: var(--surface2);
    border-radius: 6px;
  }
  .log-item-left { display: flex; align-items: center; gap: 8px; }
  .log-dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
  .log-text { color: var(--text); font-weight: 500; }
  .log-meta { color: var(--muted); font-family: 'Courier Prime', monospace; font-size: 10px; }
  .log-pct {
    font-family: 'Courier Prime', monospace;
    font-size: 10px;
    padding: 2px 7px;
    border-radius: 10px;
    background: var(--border);
    color: var(--muted2);
    flex-shrink: 0;
  }
  .log-pct.good { background: var(--green-dim); color: var(--green); }
  .log-pct.great { background: var(--accent-dim); color: var(--accent); }

  .empty-state {
    text-align: center;
    padding: 32px 16px;
    color: var(--muted);
    font-size: 12px;
    line-height: 1.6;
    font-family: 'Courier Prime', monospace;
  }
  .empty-state .big { font-size: 28px; margin-bottom: 8px; }

  /* RESET BTN */
  .reset-btn {
    display: block;
    width: 100%;
    margin-top: 10px;
    padding: 9px;
    background: transparent;
    border: 1px solid var(--border2);
    border-radius: 7px;
    color: var(--muted);
    font-family: 'Outfit', sans-serif;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.2s;
  }
  .reset-btn:hover { border-color: var(--red); color: var(--red); }

  /* TOAST */
  .toast {
    position: fixed;
    bottom: 28px;
    left: 50%;
    transform: translateX(-50%) translateY(80px);
    background: var(--surface2);
    border: 1px solid var(--border2);
    color: var(--text);
    padding: 12px 20px;
    border-radius: 10px;
    font-size: 13px;
    font-weight: 500;
    z-index: 999;
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    pointer-events: none;
    display: flex;
    align-items: center;
    gap: 8px;
    white-space: nowrap;
  }
  .toast.show { transform: translateX(-50%) translateY(0); }

  @media (max-width: 820px) {
    .content { grid-template-columns: 1fr; }
    .sidebar { display: grid; grid-template-columns: 1fr 1fr; }
  }
  @media (max-width: 560px) {
    .topbar, .day-selector-wrap, .progress-wrap, .content { padding-left: 16px; padding-right: 16px; }
    .sidebar { grid-template-columns: 1fr; }
    .day-pills { gap: 6px; }
    .day-pill { min-width: 60px; padding: 8px 10px; }
  }
</style>
</head>
<body>

<!-- TOPBAR -->
<div class="topbar">
  <div class="topbar-left">
    <div class="app-title">SEAN'S DAILY OPS</div>
    <div class="today-badge" id="real-date">...</div>
  </div>
  <div class="shift-toggle">
    <button class="shift-btn active" onclick="setShift('morning', this)">9â€“5</button>
    <button class="shift-btn" onclick="setShift('evening', this)">1â€“9</button>
  </div>
</div>

<!-- DAY SELECTOR -->
<div class="day-selector-wrap">
  <div class="day-selector-label">Select Today's Day</div>
  <div class="day-pills" id="day-pills"></div>
</div>

<!-- PROGRESS -->
<div class="progress-wrap">
  <div class="progress-header">
    <div class="progress-label">Today's Progress</div>
    <div class="progress-count" id="progress-count">0 / 0</div>
  </div>
  <div class="progress-track">
    <div class="progress-fill" id="progress-fill"></div>
  </div>
</div>

<!-- CONTENT -->
<div class="content">
  <div class="task-list" id="task-list"></div>
  <div class="sidebar">
    <!-- Streak -->
    <div class="sidebar-card">
      <h3>ðŸ”¥ Streak</h3>
      <div class="streak-display">
        <div class="streak-num" id="streak-num">0</div>
        <div class="streak-unit">days</div>
      </div>
      <div class="streak-sub" id="streak-sub">Complete any tasks to start your streak.</div>
      <div class="week-dots" id="week-dots"></div>
    </div>

    <!-- Heatmap -->
    <div class="sidebar-card">
      <h3>ðŸ“Š This Week</h3>
      <div class="heatmap" id="heatmap"></div>
    </div>

    <!-- Log -->
    <div class="sidebar-card">
      <h3>ðŸ“‹ History Log</h3>
      <div class="log-list" id="log-list"></div>
      <button class="reset-btn" onclick="confirmReset()">â†º Reset All Data</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
// â”€â”€â”€ DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DAYS = ['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday'];
const DAY_SHORT = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];

const TAG_STYLES = {
  bible:  { color: '#fbbf24', bg: 'rgba(251,191,36,0.12)',  label: 'Faith' },
  work:   { color: '#60a5fa', bg: 'rgba(96,165,250,0.12)',  label: 'Work' },
  gym:    { color: '#4ade80', bg: 'rgba(74,222,128,0.12)',  label: 'Gym' },
  run:    { color: '#2dd4bf', bg: 'rgba(45,212,191,0.12)',  label: 'Cardio' },
  linalg: { color: '#c084fc', bg: 'rgba(192,132,252,0.12)', label: 'Study' },
  jobs:   { color: '#fb923c', bg: 'rgba(251,146,60,0.12)',  label: 'Career' },
  leet:   { color: '#f472b6', bg: 'rgba(244,114,182,0.12)', label: 'LeetCode' },
  food:   { color: '#a3a3a3', bg: 'rgba(163,163,163,0.08)', label: 'Nutrition' },
  travel: { color: '#6b7280', bg: 'rgba(107,114,128,0.08)', label: 'Travel' },
  free:   { color: '#555',    bg: 'rgba(80,80,80,0.08)',    label: 'Rest' },
};

const SCHEDULES = {
  morning: {
    Monday: [
      { time: '7:00 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min â€” anchor the day', tag: 'bible' },
      { time: '7:30 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '8:20 AM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '9:00 AM', label: 'ðŸ’¼ Work', note: '9:00 â€“ 5:00 PM', tag: 'work' },
      { time: '5:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '5:30 PM', label: 'ðŸ¥— Dinner', note: 'Big meal â€” eat up for gains', tag: 'food' },
      { time: '6:15 PM', label: 'ðŸ’ª Gym', note: '10 min drive + 1 hr lift', tag: 'gym' },
      { time: '7:45 PM', label: 'ðŸ’» LeetCode', note: '1 problem â€” non-negotiable', tag: 'leet' },
      { time: '8:15 PM', label: 'ðŸ“š Linear Algebra', note: '45â€“60 min study', tag: 'linalg' },
      { time: '9:15 PM', label: 'ðŸŒ™ Snack + Water', note: 'Protein + healthy fats', tag: 'food' },
    ],
    Tuesday: [
      { time: '7:00 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min', tag: 'bible' },
      { time: '7:30 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '8:20 AM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '9:00 AM', label: 'ðŸ’¼ Work', note: '9:00 â€“ 5:00 PM', tag: 'work' },
      { time: '5:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '5:30 PM', label: 'ðŸ¥— Dinner', note: 'Big meal', tag: 'food' },
      { time: '6:30 PM', label: 'ðŸ’¼ Job Applications', note: '45 min focused window', tag: 'jobs' },
      { time: '7:30 PM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '8:00 PM', label: 'ðŸ“š Linear Algebra', note: '1 hr study', tag: 'linalg' },
      { time: '9:30 PM', label: 'ðŸŒ™ Wind Down', note: 'Snack + water + rest', tag: 'free' },
    ],
    Wednesday: [
      { time: '7:00 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min', tag: 'bible' },
      { time: '7:30 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '8:20 AM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '9:00 AM', label: 'ðŸ’¼ Work', note: '9:00 â€“ 5:00 PM', tag: 'work' },
      { time: '5:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '5:30 PM', label: 'ðŸ¥— Dinner', note: 'Big meal', tag: 'food' },
      { time: '6:15 PM', label: 'ðŸ’ª Gym', note: '10 min drive + 1 hr lift', tag: 'gym' },
      { time: '7:45 PM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '8:15 PM', label: 'ðŸŒ™ Rest / Free Time', note: 'Recovery is training too', tag: 'free' },
    ],
    Thursday: [
      { time: '7:00 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min', tag: 'bible' },
      { time: '7:30 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '8:20 AM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '9:00 AM', label: 'ðŸ’¼ Work', note: '9:00 â€“ 5:00 PM', tag: 'work' },
      { time: '5:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '5:30 PM', label: 'ðŸ¥— Dinner', note: 'Big meal', tag: 'food' },
      { time: '6:30 PM', label: 'ðŸ’¼ Job Applications', note: '45 min focused window', tag: 'jobs' },
      { time: '7:30 PM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '8:00 PM', label: 'ðŸ“š Linear Algebra', note: '1 hr study', tag: 'linalg' },
    ],
    Friday: [
      { time: '7:00 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min', tag: 'bible' },
      { time: '7:30 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '8:20 AM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '9:00 AM', label: 'ðŸ’¼ Work', note: '9:00 â€“ 5:00 PM', tag: 'work' },
      { time: '5:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '5:30 PM', label: 'ðŸ¥— Dinner', note: 'Big meal', tag: 'food' },
      { time: '6:15 PM', label: 'ðŸ’ª Gym', note: '10 min drive + 1 hr lift', tag: 'gym' },
      { time: '7:45 PM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '8:30 PM', label: 'ðŸŽ‰ Free Time', note: 'You earned it â€” rest up', tag: 'free' },
    ],
    Saturday: [
      { time: '8:00 AM', label: 'ðŸ“– Bible Study', note: '30 min â€” take your time', tag: 'bible' },
      { time: '8:30 AM', label: 'ðŸ³ Breakfast', note: 'Big weekend breakfast', tag: 'food' },
      { time: '9:30 AM', label: 'ðŸƒ Weekly Run', note: '20â€“40 min at your pace', tag: 'run' },
      { time: '10:30 AM', label: 'ðŸ“š Linear Algebra', note: '2 hr deep work block', tag: 'linalg' },
      { time: '12:30 PM', label: 'ðŸ¥— Lunch', note: 'Fuel up', tag: 'food' },
      { time: '1:30 PM', label: 'ðŸ’¼ Job Applications', note: '1 hr â€” quality over quantity', tag: 'jobs' },
      { time: '2:30 PM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '3:30 PM', label: 'ðŸŽ‰ Free Time', note: 'Rest, friends, whatever you need', tag: 'free' },
      { time: '7:00 PM', label: 'ðŸ½ï¸ Dinner', note: 'High calorie evening meal', tag: 'food' },
    ],
    Sunday: [
      { time: '8:30 AM', label: 'ðŸ“– Bible Study', note: 'Deeper Sunday study', tag: 'bible' },
      { time: '9:30 AM', label: 'ðŸ³ Breakfast', note: 'Start the day strong', tag: 'food' },
      { time: '11:00 AM', label: 'ðŸ“š Linear Algebra', note: 'Review + reinforce the week', tag: 'linalg' },
      { time: '12:30 PM', label: 'ðŸ¥— Lunch', note: 'Meal prep if possible', tag: 'food' },
      { time: '2:00 PM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '3:00 PM', label: 'ðŸ—“ï¸ Week Prep', note: 'Plan the week, set intentions', tag: 'free' },
      { time: '4:00 PM', label: 'ðŸŒ¿ Full Rest', note: 'No guilt â€” rest is productive', tag: 'free' },
      { time: '7:00 PM', label: 'ðŸ½ï¸ Dinner', note: 'High calorie evening meal', tag: 'food' },
    ],
  },
  evening: {
    Monday: [
      { time: '7:30 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min', tag: 'bible' },
      { time: '8:00 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '8:45 AM', label: 'ðŸ’ª Gym', note: '10 min drive + 1 hr lift', tag: 'gym' },
      { time: '10:15 AM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '11:00 AM', label: 'ðŸ“š Linear Algebra', note: '45 min study', tag: 'linalg' },
      { time: '12:00 PM', label: 'ðŸ¥— Lunch', note: 'Big pre-work meal', tag: 'food' },
      { time: '12:40 PM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '1:00 PM', label: 'ðŸ’¼ Work', note: '1:00 â€“ 9:00 PM', tag: 'work' },
      { time: '9:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '9:30 PM', label: 'ðŸ½ï¸ Dinner', note: 'Protein + healthy fats', tag: 'food' },
    ],
    Tuesday: [
      { time: '7:30 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min', tag: 'bible' },
      { time: '8:00 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '9:00 AM', label: 'ðŸ’¼ Job Applications', note: '45 min focused window', tag: 'jobs' },
      { time: '10:00 AM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '10:45 AM', label: 'ðŸ“š Linear Algebra', note: '1 hr study', tag: 'linalg' },
      { time: '12:00 PM', label: 'ðŸ¥— Lunch', note: 'Big pre-work meal', tag: 'food' },
      { time: '12:40 PM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '1:00 PM', label: 'ðŸ’¼ Work', note: '1:00 â€“ 9:00 PM', tag: 'work' },
      { time: '9:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '9:30 PM', label: 'ðŸ½ï¸ Dinner', note: 'Protein + healthy fats', tag: 'food' },
    ],
    Wednesday: [
      { time: '7:30 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min', tag: 'bible' },
      { time: '8:00 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '8:45 AM', label: 'ðŸ’ª Gym', note: '10 min drive + 1 hr lift', tag: 'gym' },
      { time: '10:15 AM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '11:00 AM', label: 'ðŸ“š Linear Algebra', note: '45 min study', tag: 'linalg' },
      { time: '12:00 PM', label: 'ðŸ¥— Lunch', note: 'Big pre-work meal', tag: 'food' },
      { time: '12:40 PM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '1:00 PM', label: 'ðŸ’¼ Work', note: '1:00 â€“ 9:00 PM', tag: 'work' },
      { time: '9:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '9:30 PM', label: 'ðŸ½ï¸ Dinner', note: 'Protein + healthy fats', tag: 'food' },
    ],
    Thursday: [
      { time: '7:30 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min', tag: 'bible' },
      { time: '8:00 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '9:00 AM', label: 'ðŸ’¼ Job Applications', note: '45 min focused window', tag: 'jobs' },
      { time: '10:00 AM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '10:45 AM', label: 'ðŸ“š Linear Algebra', note: '1 hr study', tag: 'linalg' },
      { time: '12:00 PM', label: 'ðŸ¥— Lunch', note: 'Big pre-work meal', tag: 'food' },
      { time: '12:40 PM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '1:00 PM', label: 'ðŸ’¼ Work', note: '1:00 â€“ 9:00 PM', tag: 'work' },
      { time: '9:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '9:30 PM', label: 'ðŸ½ï¸ Dinner', note: 'Protein + healthy fats', tag: 'food' },
    ],
    Friday: [
      { time: '7:30 AM', label: 'ðŸ“– Bible Study', note: '20â€“30 min', tag: 'bible' },
      { time: '8:00 AM', label: 'ðŸ³ Breakfast', note: 'High protein + carbs', tag: 'food' },
      { time: '8:45 AM', label: 'ðŸ’ª Gym', note: '10 min drive + 1 hr lift', tag: 'gym' },
      { time: '10:15 AM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '12:00 PM', label: 'ðŸ¥— Lunch', note: 'Big pre-work meal', tag: 'food' },
      { time: '12:40 PM', label: 'ðŸš— Travel to Work', note: '20 min drive', tag: 'travel' },
      { time: '1:00 PM', label: 'ðŸ’¼ Work', note: '1:00 â€“ 9:00 PM', tag: 'work' },
      { time: '9:00 PM', label: 'ðŸš— Travel Home', note: '20 min drive', tag: 'travel' },
      { time: '9:30 PM', label: 'ðŸ½ï¸ Dinner + Unwind', note: "Relax â€” you're done", tag: 'food' },
    ],
    Saturday: [
      { time: '8:00 AM', label: 'ðŸ“– Bible Study', note: '30 min â€” take your time', tag: 'bible' },
      { time: '8:30 AM', label: 'ðŸ³ Breakfast', note: 'Big weekend breakfast', tag: 'food' },
      { time: '9:30 AM', label: 'ðŸƒ Weekly Run', note: '20â€“40 min at your pace', tag: 'run' },
      { time: '10:30 AM', label: 'ðŸ“š Linear Algebra', note: '2 hr deep work block', tag: 'linalg' },
      { time: '12:30 PM', label: 'ðŸ¥— Lunch', note: 'Fuel up', tag: 'food' },
      { time: '1:30 PM', label: 'ðŸ’¼ Job Applications', note: '1 hr â€” quality over quantity', tag: 'jobs' },
      { time: '2:30 PM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '3:30 PM', label: 'ðŸŽ‰ Free Time', note: 'Rest, friends, whatever you need', tag: 'free' },
      { time: '7:00 PM', label: 'ðŸ½ï¸ Dinner', note: 'High calorie evening meal', tag: 'food' },
    ],
    Sunday: [
      { time: '8:30 AM', label: 'ðŸ“– Bible Study', note: 'Deeper Sunday study', tag: 'bible' },
      { time: '9:30 AM', label: 'ðŸ³ Breakfast', note: 'Start the day strong', tag: 'food' },
      { time: '11:00 AM', label: 'ðŸ“š Linear Algebra', note: 'Review + reinforce the week', tag: 'linalg' },
      { time: '12:30 PM', label: 'ðŸ¥— Lunch', note: 'Meal prep if possible', tag: 'food' },
      { time: '2:00 PM', label: 'ðŸ’» LeetCode', note: '1 problem', tag: 'leet' },
      { time: '3:00 PM', label: 'ðŸ—“ï¸ Week Prep', note: 'Plan the week, set intentions', tag: 'free' },
      { time: '4:00 PM', label: 'ðŸŒ¿ Full Rest', note: 'No guilt â€” rest is productive', tag: 'free' },
      { time: '7:00 PM', label: 'ðŸ½ï¸ Dinner', note: 'High calorie evening meal', tag: 'food' },
    ],
  }
};

// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let state = {
  shift: 'morning',
  activeDay: 'Monday',
  history: {}, // { "2024-01-15_Monday": { done: [0,1,3], total: 8 } }
};

function storageKey() { return 'dailyops_state_v2'; }

async function loadState() {
  try {
    const saved = JSON.parse(localStorage.getItem(storageKey()));
    if (saved) {
      state.shift = saved.shift || 'morning';
      state.history = saved.history || {};
    }
  } catch(e) { /* fresh start */ }
}

async function saveState() {
  try {
    localStorage.setItem(storageKey(), JSON.stringify({ shift: state.shift, history: state.history }));
  } catch(e) {}
}

function todayKey() {
  const d = new Date();
  return d.toISOString().split('T')[0];
}

function sessionKey(day) {
  return `${todayKey()}_${day}`;
}

function getSession(day) {
  const k = sessionKey(day);
  return state.history[k] || null;
}

function ensureSession(day) {
  const k = sessionKey(day);
  const tasks = SCHEDULES[state.shift][day];
  if (!state.history[k]) {
    state.history[k] = { done: [], total: tasks.length, shift: state.shift };
  }
  // If shift changed, reset done but keep key
  if (state.history[k].shift !== state.shift) {
    state.history[k] = { done: [], total: tasks.length, shift: state.shift };
  }
  return state.history[k];
}

// â”€â”€â”€ RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderDayPills() {
  const container = document.getElementById('day-pills');
  container.innerHTML = DAYS.map((day, i) => {
    const sess = getSession(day);
    const hasHistory = sess && sess.done.length > 0;
    const isActive = day === state.activeDay;
    const pct = sess ? Math.round(sess.done.length / sess.total * 100) : 0;
    return `
      <div class="day-pill ${isActive ? 'active' : ''} ${hasHistory ? 'has-history' : ''}"
           onclick="selectDay('${day}')">
        <div class="pill-done-dot"></div>
        <div class="pill-name">${DAY_SHORT[i]}</div>
        <div class="pill-sub">${hasHistory ? pct+'%' : 'â€”'}</div>
      </div>`;
  }).join('');
}

function renderTasks() {
  const day = state.activeDay;
  const tasks = SCHEDULES[state.shift][day];
  const sess = ensureSession(day);
  const container = document.getElementById('task-list');

  container.innerHTML = tasks.map((task, i) => {
    const done = sess.done.includes(i);
    const tag = TAG_STYLES[task.tag];
    return `
      <div class="task-card ${done ? 'done' : ''}" 
           style="--card-color:${tag.color}"
           onclick="toggleTask(${i})">
        <div class="task-check">${done ? 'âœ“' : ''}</div>
        <div class="task-body">
          <div class="task-time">${task.time}</div>
          <div class="task-label">${task.label}</div>
          <div class="task-note">${task.note}</div>
          <span class="task-tag" style="color:${tag.color};background:${tag.bg}">${tag.label}</span>
        </div>
      </div>`;
  }).join('');

  renderProgress(sess, tasks.length);
}

function renderProgress(sess, total) {
  const done = sess ? sess.done.length : 0;
  const pct = total > 0 ? Math.round(done / total * 100) : 0;
  document.getElementById('progress-count').textContent = `${done} / ${total}`;
  document.getElementById('progress-fill').style.width = pct + '%';
}

function renderSidebar() {
  renderStreak();
  renderHeatmap();
  renderLog();
}

function renderStreak() {
  // Count consecutive days (any day entry with >0 done in recent history)
  const entries = Object.entries(state.history)
    .filter(([k, v]) => v.done.length > 0)
    .map(([k]) => k.split('_')[0])
    .filter((v, i, a) => a.indexOf(v) === i)
    .sort();

  let streak = 0;
  const today = todayKey();
  const d = new Date(today);
  for (let i = 0; i < 365; i++) {
    const dateStr = d.toISOString().split('T')[0];
    const hasEntry = entries.includes(dateStr);
    if (hasEntry) { streak++; d.setDate(d.getDate() - 1); }
    else if (i === 0) { d.setDate(d.getDate() - 1); } // today might not be done yet
    else break;
  }

  document.getElementById('streak-num').textContent = streak;
  document.getElementById('streak-sub').textContent = streak === 0
    ? 'Complete any tasks to start your streak.'
    : streak === 1 ? 'Day 1. Every legend starts here. Keep going.'
    : streak < 7 ? `${streak} days strong. Build the habit.`
    : `${streak} days. This is becoming who you are.`;

  // Week dots
  const weekDots = document.getElementById('week-dots');
  weekDots.innerHTML = DAYS.map((day, i) => {
    const sess = getSession(day);
    const pct = sess ? sess.done.length / sess.total : 0;
    const cls = pct === 0 ? '' : pct >= 1 ? 'full' : 'partial';
    return `<div class="w-dot ${cls}" title="${day}: ${sess ? Math.round(pct*100)+'%' : 'not started'}">${DAY_SHORT[i].charAt(0)}</div>`;
  }).join('');
}

function renderHeatmap() {
  const container = document.getElementById('heatmap');
  container.innerHTML = DAYS.map((day, i) => {
    const sess = getSession(day);
    const pct = sess ? sess.done.length / sess.total : 0;
    const tag = TAG_STYLES;
    const color = pct === 0 ? '#222' : pct < 0.5 ? '#fb923c' : pct < 1 ? '#e8ff47' : '#4ade80';
    return `
      <div class="heatmap-row">
        <div class="heatmap-day-label">${DAY_SHORT[i]}</div>
        <div class="heatmap-bar-wrap">
          <div class="heatmap-bar" style="width:${Math.round(pct*100)}%;background:${color}"></div>
        </div>
        <div class="heatmap-pct">${sess ? Math.round(pct*100)+'%' : 'â€”'}</div>
      </div>`;
  }).join('');
}

function renderLog() {
  const container = document.getElementById('log-list');
  // Get all history entries, sorted newest first
  const entries = Object.entries(state.history)
    .filter(([k, v]) => v.done.length > 0)
    .sort(([a], [b]) => b.localeCompare(a))
    .slice(0, 20);

  if (entries.length === 0) {
    container.innerHTML = `<div class="empty-state"><div class="big">ðŸ“‹</div>No history yet.<br>Complete tasks to see your log here.</div>`;
    return;
  }

  container.innerHTML = entries.map(([key, val]) => {
    const [date, ...dayParts] = key.split('_');
    const day = dayParts.join('_');
    const pct = Math.round(val.done.length / val.total * 100);
    const pctClass = pct >= 100 ? 'great' : pct >= 50 ? 'good' : '';
    const dotColor = pct >= 100 ? '#4ade80' : pct >= 50 ? '#e8ff47' : '#fb923c';
    const dateObj = new Date(date + 'T12:00:00');
    const dateStr = dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
    return `
      <div class="log-item">
        <div class="log-item-left">
          <div class="log-dot" style="background:${dotColor}"></div>
          <div>
            <div class="log-text">${day}</div>
            <div class="log-meta">${dateStr} Â· ${val.shift === 'morning' ? '9â€“5' : '1â€“9'}</div>
          </div>
        </div>
        <div class="log-pct ${pctClass}">${pct}%</div>
      </div>`;
  }).join('');
}

// â”€â”€â”€ ACTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function selectDay(day) {
  state.activeDay = day;
  renderDayPills();
  renderTasks();
  renderSidebar();
}

function toggleTask(index) {
  const sess = ensureSession(state.activeDay);
  const wasDone = sess.done.includes(index);
  if (wasDone) {
    sess.done = sess.done.filter(i => i !== index);
  } else {
    sess.done.push(index);
    const tasks = SCHEDULES[state.shift][state.activeDay];
    if (sess.done.length === tasks.length) {
      showToast('ðŸ”¥ Day complete! Full send.');
    }
  }
  saveState();
  renderTasks();
  renderDayPills();
  renderSidebar();
}

function setShift(shift, btn) {
  state.shift = shift;
  document.querySelectorAll('.shift-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  saveState();
  renderDayPills();
  renderTasks();
  renderSidebar();
}

function confirmReset() {
  if (confirm('Reset all history and progress? This cannot be undone.')) {
    state.history = {};
    saveState();
    renderDayPills();
    renderTasks();
    renderSidebar();
    showToast('ðŸ—‘ï¸ All data cleared.');
  }
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2800);
}

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function init() {
  // Real date
  const now = new Date();
  document.getElementById('real-date').textContent =
    now.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });

  // Auto-select today's day
  const dayNames = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  state.activeDay = dayNames[now.getDay()];

  await loadState();

  // Sync shift buttons
  document.querySelectorAll('.shift-btn').forEach(btn => {
    btn.classList.toggle('active', btn.textContent.trim().startsWith(state.shift === 'morning' ? '9' : '1'));
  });

  renderDayPills();
  renderTasks();
  renderSidebar();
}

init();

  // Register service worker for PWA
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js').catch(() => {});
    });
  }
</script>
</body>
</html>
